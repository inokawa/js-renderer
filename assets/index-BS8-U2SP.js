(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const e of i)if(e.type==="childList")for(const r of e.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function n(i){const e={};return i.integrity&&(e.integrity=i.integrity),i.referrerPolicy&&(e.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?e.credentials="include":i.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function l(i){if(i.ep)return;i.ep=!0;const e=n(i);fetch(i.href,e)}})();class d{constructor(t){this.next=null,this.prev=null,this.firstChild=null,this.lastChild=null,this.parent=null,this.value=t,this.next=null,this.prev=null,this.firstChild=null,this.lastChild=null,this.parent=null}addChild(t){if(t.parent=this,!this.firstChild)this.firstChild=t,this.lastChild=t;else{if(!this.lastChild)throw new Error("Last child must be set.");t.prev=this.lastChild,this.lastChild.next=t,this.lastChild=t}return t}}const w=s=>Array.isArray(s)?s:[s],h=(s,t,n)=>{switch(s){case"view":{const{children:l,style:i={}}=t,e=new d(i);if(l)for(const r of w(l))e.addChild(r);return e}case"text":{const{children:l,style:i={}}=t;return new d({...i,text:l})}default:throw new Error(`${s} is unimplemented`)}},x=(s,t={})=>{const n=s.getContext("2d"),l=t.bgColor??"#000000";return{size:(i,e,r)=>{s.width=i*r,s.height=e*r,n.scale(r,r)},draw:i=>{n.fillStyle=l,n.fillRect(0,0,s.width,s.height);for(const e of i)if("text"in e){n.font=e.fontSize+"px sans-serif",n.fillStyle=e.color;const r=n.measureText(e.text),f=r.actualBoundingBoxAscent+r.actualBoundingBoxDescent;n.fillText(e.text,e.x,e.y+f)}else e.backgroundColor!=="transparent"&&(n.fillStyle=e.backgroundColor,n.fillRect(e.x,e.y,e.width,e.height))}}};class p{constructor(){this.start=null,this.end=null,this._size=0}enqueue(t){const n={data:t,next:null,prev:null};this.end?(this.end.next=n,n.prev=this.end):this.start=n,this.end=n,this._size++}dequeue(){const t=this.start;return t?(t.next?this.start=t.next:(this.start=null,this.end=null),this._size--,t.data):null}dequeueFront(){const t=this.end;return t?(t.prev?this.end=t.prev:(this.start=null,this.end=null),this._size--,t.data):null}get size(){return this._size}}const g=s=>({size:(t,n,l)=>{s.size(t,n,l)},render:t=>{const n=[],l=new p;for(l.enqueue(t);l.size;){const i=l.dequeueFront();if(!i)throw new Error("Node should exist.");const e=i.value;n.push("text"in e?{x:e.left??0,y:e.top??0,width:e.width??0,height:e.height??0,zIndex:e.zIndex??0,text:e.text,fontSize:e.fontSize??14,color:e.color??"#fff"}:{x:e.left??0,y:e.top??0,width:e.width??0,height:e.height??0,zIndex:e.zIndex??0,backgroundColor:e.backgroundColor??"transparent"});let r=i.lastChild;for(;r;){if(r.value.display==="none"){r=r.prev;continue}l.enqueue(r),r=r.prev}}n.sort((i,e)=>i.zIndex-e.zIndex),s.draw(n)}});window.addEventListener("error",s=>{alert(s.message)});const o=document.createElement("canvas");o.setAttribute("style","display: block");const u=g(x(o)),c=()=>{const s=window.devicePixelRatio,t=window.innerWidth,n=window.innerHeight;o.style.width=t+"px",o.style.height=n+"px",u.size(t,n,s)};c();document.body.appendChild(o);const a=()=>{u.render(h("view",{style:{left:70,top:100,width:50,height:50,zIndex:0,backgroundColor:"#ff00ff"},children:h("view",{style:{left:100,top:200,width:100,height:100,zIndex:0,backgroundColor:"#00ffff"}})}))};a();window.addEventListener("resize",()=>{c(),a()});
