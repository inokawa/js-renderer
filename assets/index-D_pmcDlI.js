(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const t of r)if(t.type==="childList")for(const i of t.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const t={};return r.integrity&&(t.integrity=r.integrity),r.referrerPolicy&&(t.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?t.credentials="include":r.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function l(r){if(r.ep)return;r.ep=!0;const t=n(r);fetch(r.href,t)}})();class u{constructor(e){if(this._head=null,this._tail=null,this._length=0,e)for(const n of e)this.push(n)}push(e){const n=this._tail;e.prev=n,e.next=null,n&&(n.next=e),this._tail=e,this._head||(this._head=e),this._length++}pop(){const e=this._tail;if(e)return this._tail=e.prev,this.checkHeadAndTail(),this._length--,e}shift(){const e=this._head;if(e)return this._head=e.next,this.checkHeadAndTail(),this._length--,e}checkHeadAndTail(){this._head&&(this._head.prev=null),this._tail&&(this._tail.next=null),this._head||(this._tail=null),this._tail||(this._head=null)}get length(){return this._length}get first(){return this._head}get last(){return this._tail}}class d{constructor(e){this.parent=null,this.prev=null,this.next=null,this.value=e,this.children=new u}get firstChild(){return this.children.first}get lastChild(){return this.children.last}addChild(e){e.parent=this,this.children.push(e)}}const w=s=>Array.isArray(s)?s:[s],c=(s,e,n)=>{switch(s){case"view":{const{children:l,style:r={}}=e,t=new d(r);if(l)for(const i of w(l))t.addChild(i);return t}case"text":{const{children:l,style:r={}}=e;return new d({...r,text:l})}default:throw new Error(`${s} is unimplemented`)}},x=(s,e={})=>{const n=s.getContext("2d"),l=e.bgColor??"#000000",r=(t,i)=>{n.font=i;const o=n.measureText(t);return{width:o.width,height:o.actualBoundingBoxAscent+o.actualBoundingBoxDescent}};return{size:(t,i,o)=>{s.width=t*o,s.height=i*o,n.scale(o,o)},measureText:r,draw:t=>{n.fillStyle=l,n.fillRect(0,0,s.width,s.height);for(const i of t)if("text"in i){const o=i.fontSize+"px sans-serif",{height:p}=r(i.text,o);n.font=o,n.fillStyle=i.color,n.fillText(i.text,i.x,i.y+p)}else i.backgroundColor!=="transparent"&&(n.fillStyle=i.backgroundColor,n.fillRect(i.x,i.y,i.width,i.height))}}};class y{constructor(){this.list=new u}enqueue(e){this.list.push({value:e,next:null,prev:null})}dequeue(){return this.list.pop()?.value}dequeueFront(){return this.list.shift()?.value}get size(){return this.list.length}}const _=s=>({size:(e,n,l)=>{s.size(e,n,l)},render:e=>{const n=[],l=new y;for(l.enqueue(e);l.size;){const r=l.dequeueFront();if(!r)throw new Error("Node should exist.");const t=r.value;n.push("text"in t?{x:t.left??0,y:t.top??0,width:t.width??0,height:t.height??0,zIndex:t.zIndex??0,text:t.text,fontSize:t.fontSize??14,color:t.color??"#fff"}:{x:t.left??0,y:t.top??0,width:t.width??0,height:t.height??0,zIndex:t.zIndex??0,backgroundColor:t.backgroundColor??"transparent"});let i=r.lastChild;for(;i;){if(i.value.display==="none"){i=i.prev;continue}l.enqueue(i),i=i.prev}}n.sort((r,t)=>r.zIndex-t.zIndex),s.draw(n)}});window.addEventListener("error",s=>{alert(s.message)});const h=document.createElement("canvas");h.setAttribute("style","display: block");const a=_(x(h)),f=()=>{const s=window.devicePixelRatio,e=window.innerWidth,n=window.innerHeight;h.style.width=e+"px",h.style.height=n+"px",a.size(e,n,s)};f();document.body.appendChild(h);const g=()=>{a.render(c("view",{style:{left:70,top:100,width:50,height:50,zIndex:0,backgroundColor:"#ff00ff"},children:c("view",{style:{left:100,top:200,width:100,height:100,zIndex:0,backgroundColor:"#00ffff"}})}))};g();window.addEventListener("resize",()=>{f(),g()});
