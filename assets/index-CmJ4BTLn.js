(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const t of r)if(t.type==="childList")for(const n of t.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&l(n)}).observe(document,{childList:!0,subtree:!0});function i(r){const t={};return r.integrity&&(t.integrity=r.integrity),r.referrerPolicy&&(t.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?t.credentials="include":r.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function l(r){if(r.ep)return;r.ep=!0;const t=i(r);fetch(r.href,t)}})();class w{constructor(e){if(this._head=null,this._tail=null,this._length=0,e)for(const i of e)this.push(i)}push(e){e.prev=this._tail,e.next=null,this._tail&&(this._tail.next=e),this._tail=e,this._head||(this._head=e),this._length++}get length(){return this._length}get first(){return this._head??null}get last(){return this._tail??null}}class d{constructor(e){this.parent=null,this.prev=null,this.next=null,this.value=e,this.children=new w}get firstChild(){return this.children.first??null}get lastChild(){return this.children.last??null}addChild(e){e.parent=this,this.children.push(e)}}const x=s=>Array.isArray(s)?s:[s],u=(s,e,i)=>{switch(s){case"view":{const{children:l,style:r={}}=e,t=new d(r);if(l)for(const n of x(l))t.addChild(n);return t}case"text":{const{children:l,style:r={}}=e;return new d({...r,text:l})}default:throw new Error(`${s} is unimplemented`)}},p=(s,e={})=>{const i=s.getContext("2d"),l=e.bgColor??"#000000",r=(t,n)=>{i.font=n;const o=i.measureText(t);return{width:o.width,height:o.actualBoundingBoxAscent+o.actualBoundingBoxDescent}};return{size:(t,n,o)=>{s.width=t*o,s.height=n*o,i.scale(o,o)},measureText:r,draw:t=>{i.fillStyle=l,i.fillRect(0,0,s.width,s.height);for(const n of t)if("text"in n){const o=n.fontSize+"px sans-serif",{height:g}=r(n.text,o);i.font=o,i.fillStyle=n.color,i.fillText(n.text,n.x,n.y+g)}else n.backgroundColor!=="transparent"&&(i.fillStyle=n.backgroundColor,i.fillRect(n.x,n.y,n.width,n.height))}}};class y{constructor(){this.start=null,this.end=null,this._size=0}enqueue(e){const i={data:e,next:null,prev:null};this.end?(this.end.next=i,i.prev=this.end):this.start=i,this.end=i,this._size++}dequeue(){const e=this.start;return e?(e.next?this.start=e.next:(this.start=null,this.end=null),this._size--,e.data):null}dequeueFront(){const e=this.end;return e?(e.prev?this.end=e.prev:(this.start=null,this.end=null),this._size--,e.data):null}get size(){return this._size}}const z=s=>({size:(e,i,l)=>{s.size(e,i,l)},render:e=>{const i=[],l=new y;for(l.enqueue(e);l.size;){const r=l.dequeueFront();if(!r)throw new Error("Node should exist.");const t=r.value;i.push("text"in t?{x:t.left??0,y:t.top??0,width:t.width??0,height:t.height??0,zIndex:t.zIndex??0,text:t.text,fontSize:t.fontSize??14,color:t.color??"#fff"}:{x:t.left??0,y:t.top??0,width:t.width??0,height:t.height??0,zIndex:t.zIndex??0,backgroundColor:t.backgroundColor??"transparent"});let n=r.lastChild;for(;n;){if(n.value.display==="none"){n=n.prev;continue}l.enqueue(n),n=n.prev}}i.sort((r,t)=>r.zIndex-t.zIndex),s.draw(i)}});window.addEventListener("error",s=>{alert(s.message)});const h=document.createElement("canvas");h.setAttribute("style","display: block");const c=z(p(h)),a=()=>{const s=window.devicePixelRatio,e=window.innerWidth,i=window.innerHeight;h.style.width=e+"px",h.style.height=i+"px",c.size(e,i,s)};a();document.body.appendChild(h);const f=()=>{c.render(u("view",{style:{left:70,top:100,width:50,height:50,zIndex:0,backgroundColor:"#ff00ff"},children:u("view",{style:{left:100,top:200,width:100,height:100,zIndex:0,backgroundColor:"#00ffff"}})}))};f();window.addEventListener("resize",()=>{a(),f()});
