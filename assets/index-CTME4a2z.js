(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const e of i)if(e.type==="childList")for(const l of e.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const e={};return i.integrity&&(e.integrity=i.integrity),i.referrerPolicy&&(e.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?e.credentials="include":i.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function r(i){if(i.ep)return;i.ep=!0;const e=n(i);fetch(i.href,e)}})();class f{constructor(t){this.next=null,this.prev=null,this.firstChild=null,this.lastChild=null,this.parent=null,this.value=t,this.next=null,this.prev=null,this.firstChild=null,this.lastChild=null,this.parent=null}addChild(t){if(t.parent=this,!this.firstChild)this.firstChild=t,this.lastChild=t;else{if(!this.lastChild)throw new Error("Last child must be set.");t.prev=this.lastChild,this.lastChild.next=t,this.lastChild=t}return t}}const p=s=>Array.isArray(s)?s:[s],u=(s,t,n)=>{switch(s){case"view":{const{children:r,...i}=t,e=new f({input:{},...i});if(r)for(const l of p(r))e.addChild(l);return e}default:throw new Error(`${s} is unimplemented`)}},w=(s,t={})=>{const n=s.getContext("2d"),r=t.bgColor??"#000000";return{size:(i,e,l)=>{s.width=i*l,s.height=e*l,n.scale(l,l)},draw:i=>{n.fillStyle=r,n.fillRect(0,0,s.width,s.height);for(const e of i)if("text"in e.input){n.font=e.input.fontSize+"px sans-serif",n.fillStyle=e.input.color;const l=n.measureText(e.input.text),a=l.actualBoundingBoxAscent+l.actualBoundingBoxDescent;n.fillText(e.input.text,e.x,e.y+a)}else e.backgroundColor!=="transparent"&&(n.fillStyle=e.backgroundColor,n.fillRect(e.x,e.y,e.width,e.height))}}};class x{constructor(){this.start=null,this.end=null,this._size=0}enqueue(t){const n={data:t,next:null,prev:null};this.end?(this.end.next=n,n.prev=this.end):this.start=n,this.end=n,this._size++}dequeue(){const t=this.start;return t===null?null:(t.next?this.start=t.next:(this.start=null,this.end=null),this._size--,t.data)}dequeueFront(){const t=this.end;return t===null?null:(t.prev?this.end=t.prev:(this.start=null,this.end=null),this._size--,t.data)}get size(){return this._size}}const g=s=>({size:(t,n,r)=>{s.size(t,n,r)},render:t=>{const n=[],r=new x;for(r.enqueue(t);r.size;){const i=r.dequeueFront();if(!i)throw new Error("Node should exist.");n.push(i.value);let e=i.lastChild;for(;e;){if(!("text"in e.value.input)&&e.value.input.display==="none"){e=e.prev;continue}r.enqueue(e),e=e.prev}}n.sort((i,e)=>i.zIndex-e.zIndex),s.draw(n)}});window.addEventListener("error",s=>{alert(s.message)});const o=document.createElement("canvas");o.setAttribute("style","display: block");const d=g(w(o)),h=()=>{const s=window.devicePixelRatio,t=window.innerWidth,n=window.innerHeight;o.style.width=t+"px",o.style.height=n+"px",d.size(t,n,s)};h();document.body.appendChild(o);const c=()=>{d.render(u("view",{x:70,y:100,width:50,height:50,zIndex:0,backgroundColor:"#ff00ff",children:u("view",{x:100,y:200,width:100,height:100,zIndex:0,backgroundColor:"#00ffff"})}))};c();window.addEventListener("resize",()=>{h(),c()});
