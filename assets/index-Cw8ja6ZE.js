(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const e of s)if(e.type==="childList")for(const i of e.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const e={};return s.integrity&&(e.integrity=s.integrity),s.referrerPolicy&&(e.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?e.credentials="include":s.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function l(s){if(s.ep)return;s.ep=!0;const e=n(s);fetch(s.href,e)}})();class u{constructor(t){if(this._head=null,this._tail=null,this._length=0,t)for(const n of t)this.push(n)}push(t){const n=this._tail;t.prev=n,t.next=null,n&&(n.next=t),this._tail=t,this._head||(this._head=t),this._length++}pop(){const t=this._tail;if(t)return this._tail=t.prev,this.checkHeadAndTail(),this._length--,t}shift(){const t=this._head;if(t)return this._head=t.next,this.checkHeadAndTail(),this._length--,t}checkHeadAndTail(){this._head&&(this._head.prev=null),this._tail&&(this._tail.next=null),this._head||(this._tail=null),this._tail||(this._head=null)}get length(){return this._length}get first(){return this._head}get last(){return this._tail}}class c{constructor(t){this.parent=null,this.prev=null,this.next=null,this.value=t,this.children=new u}get firstChild(){return this.children.first}get lastChild(){return this.children.last}addChild(t){t.parent=this,this.children.push(t)}}const w=r=>Array.isArray(r)?r:[r],d=(r,t,n)=>{switch(r){case"view":{const{children:l,style:s={}}=t,e=new c(s);if(l)for(const i of w(l))e.addChild(i);return e}case"text":{const{children:l,style:s={}}=t;return new c({...s,text:l})}default:throw new Error(`${r} is unimplemented`)}},x=(r,t={})=>{const n=r.getContext("2d"),l=t.bgColor??"#000000",s=(e,i)=>{n.font=i;const o=n.measureText(e);return{width:o.width,height:o.actualBoundingBoxAscent+o.actualBoundingBoxDescent}};return{size:(e,i,o)=>{r.width=e*o,r.height=i*o,n.scale(o,o)},measureText:s,draw:e=>{n.fillStyle=l,n.fillRect(0,0,r.width,r.height);for(const i of e)if("text"in i){const o=i.fontSize+"px sans-serif",{height:p}=s(i.text,o);n.font=o,n.fillStyle=i.color,n.fillText(i.text,i.x,i.y+p)}else i.backgroundColor!=="transparent"&&(n.fillStyle=i.backgroundColor,n.fillRect(i.x,i.y,i.width,i.height))}}};class y{constructor(){this.list=new u}push(t){this.list.push({value:t,next:null,prev:null})}pop(){return this.list.pop()?.value}shift(){return this.list.shift()?.value}get length(){return this.list.length}}const _=r=>({size:(t,n,l)=>{r.size(t,n,l)},render:t=>{const n=[],l=new y;for(l.push(t);l.length;){const s=l.shift();if(!s)throw new Error("Node should exist.");const e=s.value;n.push("text"in e?{x:e.left??0,y:e.top??0,width:e.width??0,height:e.height??0,zIndex:e.zIndex??0,text:e.text,fontSize:e.fontSize??14,color:e.color??"#fff"}:{x:e.left??0,y:e.top??0,width:e.width??0,height:e.height??0,zIndex:e.zIndex??0,backgroundColor:e.backgroundColor??"transparent"});let i=s.lastChild;for(;i;){if(i.value.display==="none"){i=i.prev;continue}l.push(i),i=i.prev}}n.sort((s,e)=>s.zIndex-e.zIndex),r.draw(n)}});window.addEventListener("error",r=>{alert(r.message)});const h=document.createElement("canvas");h.setAttribute("style","display: block");const a=_(x(h)),f=()=>{const r=window.devicePixelRatio,t=window.innerWidth,n=window.innerHeight;h.style.width=t+"px",h.style.height=n+"px",a.size(t,n,r)};f();document.body.appendChild(h);const g=()=>{a.render(d("view",{style:{left:70,top:100,width:50,height:50,zIndex:0,backgroundColor:"#ff00ff"},children:d("view",{style:{left:100,top:200,width:100,height:100,zIndex:0,backgroundColor:"#00ffff"}})}))};g();window.addEventListener("resize",()=>{f(),g()});
